{% extends "base/base.html" %}
{% load static %}

{% block head %} 
<link rel="stylesheet" href="{% static 'flash/flash_list.css' %}">
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDZLQne-DOUQDfifh3ZP_79TmL2OmBOI7k&libraries=places&callback=initMap"></script>
<script defer src="{% static 'flash/flash_map_list.js' %}"></script>
{% endblock %}

{% block header_content %}
<a id="myPage" href="#">My Page</a>
{% endblock %}

{% block content %}
<!-- 지도 위 문구 -->
<section class="flash_title">
    <h2>여행 속 반짝이는 만남, <span class="highlight">번개 모임</span></h2>
</section>
<div class="flash_searchBar">
    <form method='GET' class="flash_filter">
        {% csrf_token %}
        <div class="filter-group">
            <input type="text" id="city" name="city" placeholder="도시">
        </div>
        <div class="filter-group">
            <select id="gender" name="gender">
                <option value="">전체</option>
                <option value="mixed">혼성</option>
                <option value="male">남성만</option>
                <option value="female">여성만</option>
            </select>
        </div>
        <div class="filter-group">
            <input type="date" id="start-date" name="start-date" placeholder="시작일">
        </div>
        <div class="filter-group">
            <input type="date" id="start-date" name="start-date" placeholder="시작일">
        </div>
        <div class="filter-group">
            <input type="number" id="age" name="age" placeholder="나이">
        </div>
        <button type="submit">검색</button>
    </form>
</div>
<div class="flash_container">
    <!-- 지도 -->
    <div class="flash_left">
        <section class="flash_list_header">
            <h2 class="flash_list_title">12개의 모집중인 번개</h2>
            <div class="flash_list_controls">
                <h2>나만의 번개</h2>
                <a href="{% url 'flash:flash_register' %}" class="flash_register_btn">등록하기</a>
            </div>
        </section>
        
        <!-- 구분선 -->
        <hr class="flash_list_divider">
        
        <!-- 모집 중인 번개 리스트 -->        
        <section class="flash_list">
            <section class="flash_list_body">
                {% for flash in flash_meetings %}
                <div class="flash_card"
                    data-lat="{{ flash.latitude }}"
                    data-lng="{{ flash.longitude }}"
                    data-date="{{ flash.date_time|date:'Y-m-d H:i' }}"
                    data-place-address="{{ flash.city }}">
                    <a href="{% url 'flash:flash_detail' flash.meeting_id %}">
                        <img id="place-img-{{ flash.meeting_id }}" src="https://via.placeholder.com/300" alt="모임 이미지">
                    </a>
                    <div class="flash_card_info">
                        <h3><a href="{% url 'flash:flash_detail' flash.meeting_id %}">{{ flash.title }}</a></h3>
                        <p class="flash_place">{{ flash.city }}</p>
                        <p class="flash_date">{{ flash.date_time|date:"Y년 m월 d일 H:i" }}</p>
                        <div class="flash_card_tags">
                            {% for tag in flash.tag_list %}
                                <span class="flash_tag">#{{ tag }}</span>
                            {% empty %}
                                <span class="flash_tag">태그 없음</span>
                            {% endfor %}
                        </div>
                        <span class="flash_capacity">{{ flash.max_people }}</span>
                    </div>
                </div>
                {% empty %}
                <p>등록된 번개 모임이 없습니다.</p>
                {% endfor %}
            </section>
            
        </section>
    </div>

    <section class="flash_map">
        <input id="search-bar" type="text" placeholder="장소를 검색하세요">
        <div id="map"></div>
    </section>
    
</div>

{% endblock %}
